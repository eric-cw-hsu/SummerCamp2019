@model BookManagement.Models.BookSearchArg
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2 style="font-family:Microsoft JhengHei;">圖書維護</h2>

<table class="table table-bordered table-hover">
    <tr>
        <td>書名</td>
        <td>
            <input id="BookName" />
        </td>
    </tr>
    <tr>
        <td>圖書類別</td>
        <td>
            <select id="BookClass"></select>
        </td>
    </tr>
    <tr>
        <td>借閱人</td>
        <td>
            <select id="BookLendUser"></select>
        </td>
    </tr>
    <tr>
        <td>借閱狀態</td>
        <td>
            <select id="BookStatus"></select>
        </td>
    </tr>
    <tr>
        <td></td>
        <td>
            <button id="SearchBtn">查詢</button>
            <button id="ClearBtn">清除</button>
            <button id="InsertBtn">新增</button>
        </td>
    </tr>
</table>

<div id="book_grid"></div>

<script>
    $(document).ready(function () {
        $("#BookClass").kendoDropDownList({
            dataTextField: "Text",
            dataValueField: "Value",
            dataSource: {
                transport: {
                    read: {
                        method: "post",
                        dataType: "json",
                        url: "GetClass"
                    }
                }
            },
            index: 0
        });

        $("#BookLendUser").kendoDropDownList({
            dataTextField: "Text",
            dataValueField: "Value",
            dataSource: {
                transport: {
                    read: {
                        method: "post",
                        dataType: "json",
                        url: "GetUserName"
                    }
                }
            },
            index: 0
        });

        $("#BookStatus").kendoDropDownList({
            dataTextField: "Text",
            dataValueField: "Value",
            dataSource: {
                transport: {
                    read: {
                        method: "post",
                        dataType: "json",
                        url: "GetStatus"
                    }
                }
            },
            index: 0
        });
        
        $("#ClearBtn").click(function () {
            location = "/Library/Index";
        })

        $("#InsertBtn").click(function () {
            location = "/Library/InsertBook"
        })

        $("#SearchBtn").click(function () {
            var SearchData = {
                "BookName": $('#BookName').val(),
                "BookClassId": $('#BookClass').val(),
                "KeeperId": $('#BookKeeper').val(),
                "BookStatusId": $('#BookStatus').val()
            }

            $("#book_grid").kendoGrid({
                dataSource: {
                    transport: {
                        read: {
                            method: "post",
                            dataType: "json",
                            url: "GetBookData"
                        }
                    },
                    schema: {
                        model: {
                            fields: {
                                BookId: { type: "int" },
                                BookName: { type: "string" },
                                BookCastegory: { type: "string" },
                                BookAuthor: { type: "string" },
                                BookBoughtDate: { type: "string" },
                                BookPublisher: { type: "string" }
                            }
                        }
                    },
                    pageSize: 20,
                },
                //toolbar: kendo.template("<div class='book-grid-toolbar'><input class='book-grid-search' placeholder='我想要找......' type='text'></input></div>"),
                height: 550,
                sortable: true,
                pageable: {
                    input: true,
                    numeric: false
                },
                columns: [
                    { field: "BookName", title: "書名", width: "40%" },
                    { field: "UserName", title: "借閱人", width: "20%" },
                    { field: "BookClassName", title: "圖書類別", width: "20%" },
                    { field: "CodeName", title: "借閱狀態", width: "10%" },
                    { command: { text: "刪除", /*click: deleteBook*/ }, title: " ", width: "120px" }
                ]
            });
        });

       
        

       
    });


</script>